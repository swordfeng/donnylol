!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1);self.addEventListener("fetch",e=>{try{e.respondWith(r.handleRequest(e.request))}catch(t){e.respondWith(fetch(e.request))}}),self.addEventListener("sync",e=>{e.waitUntil(r.syncRules())})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.syncRules=t.handleRequest=void 0;const r=n(2);async function o(){const e=new Request("/rules.json"),t=await fetch(e);if(!t.ok)throw new Error("no rules available");const n=new Headers;n.set("cache-control","public, max-age=604800, immutable");const r=new Response(t.body,{status:t.status,statusText:t.statusText,headers:n});return caches.open("rules").then(t=>t.put(e,r)),t}t.handleRequest=async function(e){const t=new URL(e.url);if("/"===t.pathname){const e=await async function(){let e=await caches.match(new Request("/rules.json"));e||(e=await o());return e.json()}(),n=t.searchParams.get("q");if(n){const t=r.handleQuery(n,e);if(t)return Response.redirect(t,302)}}return fetch(e)},t.syncRules=o},function(e,t,n){"use strict";function r(e,t){const n=e.indexOf(" "),r=-1===n?e:e.slice(0,n),o=-1===n?"":e.slice(n+1);for(const n of t){if(n.keywords&&-1!==n.keywords.indexOf(r)&&(o||n.default))return{rule:n,keyword:r,remainQuery:o};if(n.match){const t=new RegExp("^(?:"+n.match+")(?=$| )").exec(e);if(t){const r=e.slice(t[0].length+1);if(r||n.default)return{rule:n,keyword:t[0],remainQuery:r,match:t}}}if(!n.keywords&&!n.match)return{rule:n,keyword:"",remainQuery:e}}return null}function o(e,t,n,r){if(e=(e=e.replace(/\{keyword\}/g,encodeURIComponent(t))).replace(/\{query\}/g,encodeURIComponent(n).replace(/%20/g,"+")),r)for(let t=1;t<r.length;t++)e=e.replace(new RegExp(`\\{${t}\\}`,"g"),encodeURIComponent(r[t]));return e}Object.defineProperty(t,"__esModule",{value:!0}),t.handleSuggestion=t.handleQuery=void 0,t.handleQuery=function(e,t){const n=r(e,t);if(!n)return null;const{rule:u,keyword:s,remainQuery:c,match:a}=n;return!c&&u.default?o(u.default,s,c,a):o(u.search,s,c,a)},t.handleSuggestion=async function(e,t){const n=r(e,t);if(!n)return[e,[],[],[]];const{rule:u,keyword:s,remainQuery:c,match:a}=n;if(!c||!u.suggestion)return[e,[],[],[]];const i=o(u.suggestion,s,c,a),l=await fetch(new Request(i)),f=await l.json();return f[0]!==c?[e,[],[],[]]:(f[0]=e,f[1]=f[1].map(e=>`${s} ${e}`),f)}}]);